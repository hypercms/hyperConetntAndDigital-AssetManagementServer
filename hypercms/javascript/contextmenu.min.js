if(null!==localStorage.getItem("is_mobile")&&"false"==localStorage.getItem("is_mobile"))var is_mobile=!1;else is_mobile=!0;var contextenable=!0,contextxmove=!0,contextymove=!0,tempX=0,tempY=0,scrollX=0,scrollY=0,allow_tr_submit=!0,activatelinks=!1,selectarea=null,is_selectarea=!1,x1=0,y1=0,x2=0,y2=0,x3=0,y3=0,x4=0,y4=0,is_dragndrop=!1,themelocation="";function hcms_clearSelection(){selectarea&&0==activatelinks&&(window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty())}function hcms_loadSidebar(){if(parent.document.getElementById("sidebarLayer")&&"0px"!=parent.document.getElementById("sidebarLayer").style.width&&document.forms.contextmenu_object){hcms_sleep(200);var e=document.forms.contextmenu_object.elements.location.value,t=document.forms.contextmenu_object.elements.folder.value,n=document.forms.contextmenu_object.elements.page.value;return!allow_tr_submit||""==e||""==t&&""==n?allow_tr_submit=!0:parent.document.getElementById("sidebarFrame").src="explorer_preview.php?location="+encodeURIComponent(e)+"&folder="+encodeURIComponent(t)+"&page="+encodeURIComponent(n),!0}return!1}function hcms_resetContext(){if(document.forms.contextmenu_object&&"hidden"==document.forms.contextmenu_object.elements.contextmenustatus.value)(e=document.forms.contextmenu_object).elements.contexttype.value="none",e.elements.page.value="",e.elements.pagename.value="",e.elements.filetype.value="",e.elements.media.value="",e.elements.folder.value="",e.elements.folder_id&&(e.elements.folder_id.value="");else if(document.forms.contextmenu_user&&"hidden"==document.forms.contextmenu_user.elements.contextmenustatus.value){(e=document.forms.contextmenu_user).elements.login.value=""}else if(document.forms.contextmenu_queue&&"hidden"==document.forms.contextmenu_queue.elements.contextmenustatus.value){var e;(e=document.forms.contextmenu_queue).elements.site.value="",e.elements.cat.value="",e.elements.location.value="",e.elements.page.value="",e.elements.pagename.value="",e.elements.filetype.value="",e.elements.queueuser.value="",e.elements.queue_id.value=""}return!0}function hcms_lockContext(e){return"true"!=e&&1!=e&&"false"!=e&&0!=e||(1==e&&(e="true"),0==e&&(e="false"),document.forms.contextmenu_object?document.forms.contextmenu_object.elements.contextmenulocked.value=e:document.forms.contextmenu_user?document.forms.contextmenu_user.elements.contextmenulocked.value=e:document.forms.contextmenu_queue&&(document.forms.contextmenu_queue.elements.contextmenulocked.value=e)),!0}function hcms_isLockedContext(){var e="false";if(document.forms.contextmenu_object?e=document.forms.contextmenu_object.elements.contextmenulocked.value:document.forms.contextmenu_user?e=document.forms.contextmenu_user.elements.contextmenulocked.value:document.forms.contextmenu_queue&&(e=document.forms.contextmenu_queue.elements.contextmenulocked.value),"true"==e||1==e)var t=!0;else t=!1;return t}function hcms_getMouseXY(e){if(!e)e=window.event;return e.clientX||e.clientY?(hcms_getScrollXY(),tempX=e.clientX+scrollX,tempY=e.clientY+scrollY,x2=e.clientX,y2=e.clientY):(e.pageX||e.pageY)&&(tempX=e.pageX,tempY=e.pageY,x2=e.pageX,y2=e.pageY),tempX<0&&(tempX=0),tempY<0&&(tempY=0),hcms_drawSelectArea(),!0}function hcms_getScrollXY(){return"number"==typeof window.pageYOffset?(scrollY=window.pageYOffset,scrollX=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(scrollY=document.body.scrollTop,scrollX=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(scrollY=document.documentElement.scrollTop,scrollX=document.documentElement.scrollLeft),!0}function hcms_getWindowWidth(e){return null==e&&(e=window),e.innerWidth?e.innerWidth:e.document.documentElement&&e.document.documentElement.clientWidth?e.document.documentElement.clientWidth:e.document.body.offsetWidth}function hcms_getWindowHeight(e){return null==e&&(e=window),e.innerHeight?e.innerHeight:e.document.documentElement&&e.document.documentElement.clientHeight?e.document.documentElement.clientHeight:e.document.body.offsetHeight}function hcms_positionContextmenu(){if(document.all){var e=document.all.contextLayer;tempY>hcms_getWindowHeight()/2?yoffset=parseInt(e.style.height)+0:yoffset=5,contextxmove&&(e.style.left=tempX-5+"px"),contextymove&&(e.style.top=tempY-yoffset+"px"),e.style.visibility="visible"}else if(document.layers){e=document.layers.contextLayer;tempY>hcms_getWindowHeight()/2?yoffset=parseInt(e.style.height)+0:yoffset=5,contextxmove&&(e.left=tempX-5+"px"),contextymove&&(e.top=tempY-yoffset+"px"),e.visibility="visible"}else{e=document.getElementById("contextLayer");tempY>hcms_getWindowHeight()/2?yoffset=parseInt(e.style.height)+0:yoffset=5,contextxmove&&(e.style.left=tempX-5+"px"),contextymove&&(e.style.top=tempY-yoffset+"px"),e.style.visibility="visible"}return!0}function hcms_showContextmenu(){if(document.forms.contextmenu_object){document.forms.contextmenu_object.elements.contextmenustatus.value="visible";var e=document.forms.contextmenu_object.elements.contexttype.value,t=(o=document.forms.contextmenu_object.elements.multiobject.value).split("|").length-1;if(contextenable)if("object"==e||"folder"==e||""!=o&&"media"==e){if(document.getElementById("img_preview")&&(document.getElementById("img_preview").className="hcmsIconOn hcmsIconList"),document.getElementById("img_cmsview")&&(document.getElementById("img_cmsview").className="hcmsIconOn hcmsIconList"),document.getElementById("img_notify")&&(document.getElementById("img_notify").className="hcmsIconOn hcmsIconList"),document.getElementById("img_chat")&&t<=1?document.getElementById("img_chat").className="hcmsIconOn hcmsIconList":document.getElementById("img_chat")&&(document.getElementById("img_chat").className="hcmsIconOff hcmsIconList"),document.getElementById("img_restore")&&(document.getElementById("img_restore").className="hcmsIconOn hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOn hcmsIconList"),document.getElementById("img_cut")&&(document.getElementById("img_cut").className="hcmsIconOn hcmsIconList"),document.getElementById("img_copy")&&(document.getElementById("img_copy").className="hcmsIconOn hcmsIconList"),document.getElementById("img_copylinked")&&(document.getElementById("img_copylinked").className="hcmsIconOn hcmsIconList"),document.getElementById("img_publish")&&(document.getElementById("img_publish").className="hcmsIconOn hcmsIconList"),document.getElementById("img_unpublish")&&(document.getElementById("img_unpublish").className="hcmsIconOn hcmsIconList"),document.getElementById("img_unlock")&&(document.getElementById("img_unlock").className="hcmsIconOn hcmsIconList"),document.getElementById("img_fav_create")&&(document.getElementById("img_fav_create").className="hcmsIconOn hcmsIconList"),document.getElementById("img_fav_delete")&&(document.getElementById("img_fav_delete").className="hcmsIconOn hcmsIconList"),document.getElementsByName("img_plugin"))for(var n=document.getElementsByName("img_plugin"),m=0;m<n.length;m++)n[m].className="hcmsIconOn hcmsIconList"}else if(""==o&&"media"==e){if(document.getElementById("img_preview")&&(document.getElementById("img_preview").className="hcmsIconOn hcmsIconList"),document.getElementById("img_cmsview")&&(document.getElementById("img_cmsview").className="hcmsIconOn hcmsIconList"),document.getElementById("img_notify")&&(document.getElementById("img_notify").className="hcmsIconOn hcmsIconList"),document.getElementById("img_chat")&&t<=1?document.getElementById("img_chat").className="hcmsIconOn hcmsIconList":document.getElementById("img_chat")&&(document.getElementById("img_chat").className="hcmsIconOff hcmsIconList"),document.getElementById("img_restore")&&(document.getElementById("img_restore").className="hcmsIconOn hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOn hcmsIconList"),document.getElementById("img_cut")&&(document.getElementById("img_cut").className="hcmsIconOn hcmsIconList"),document.getElementById("img_copy")&&(document.getElementById("img_copy").className="hcmsIconOn hcmsIconList"),document.getElementById("img_copylinked")&&(document.getElementById("img_copylinked").className="hcmsIconOn hcmsIconList"),document.getElementById("img_publish")&&(document.getElementById("img_publish").className="hcmsIconOn hcmsIconList"),document.getElementById("img_unpublish")&&(document.getElementById("img_unpublish").className="hcmsIconOn hcmsIconList"),document.getElementById("img_unlock")&&(document.getElementById("img_unlock").className="hcmsIconOn hcmsIconList"),document.getElementById("img_fav_create")&&(document.getElementById("img_fav_create").className="hcmsIconOn hcmsIconList"),document.getElementById("img_fav_delete")&&(document.getElementById("img_fav_delete").className="hcmsIconOn hcmsIconList"),document.getElementsByName("img_plugin"))for(n=document.getElementsByName("img_plugin"),m=0;m<n.length;m++)n[m].className="hcmsIconOn hcmsIconList"}else if(document.getElementById("img_preview")&&(document.getElementById("img_preview").className="hcmsIconOff hcmsIconList"),document.getElementById("img_cmsview")&&(document.getElementById("img_cmsview").className="hcmsIconOff hcmsIconList"),document.getElementById("img_notify")&&(document.getElementById("img_notify").className="hcmsIconOff hcmsIconList"),document.getElementById("img_chat")&&(document.getElementById("img_chat").className="hcmsIconOff hcmsIconList"),document.getElementById("img_restore")&&(document.getElementById("img_restore").className="hcmsIconOff hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOff hcmsIconList"),document.getElementById("img_cut")&&(document.getElementById("img_cut").className="hcmsIconOff hcmsIconList"),document.getElementById("img_copy")&&(document.getElementById("img_copy").className="hcmsIconOff hcmsIconList"),document.getElementById("img_copylinked")&&(document.getElementById("img_copylinked").className="hcmsIconOff hcmsIconList"),document.getElementById("img_publish")&&(document.getElementById("img_publish").className="hcmsIconOff hcmsIconList"),document.getElementById("img_unpublish")&&(document.getElementById("img_unpublish").className="hcmsIconOff hcmsIconList"),document.getElementById("img_unlock")&&(document.getElementById("img_unlock").className="hcmsIconOff hcmsIconList"),document.getElementById("img_fav_create")&&(document.getElementById("img_fav_create").className="hcmsIconOff hcmsIconList"),document.getElementById("img_fav_delete")&&(document.getElementById("img_fav_delete").className="hcmsIconOff hcmsIconList"),document.getElementsByName("img_plugin"))for(n=document.getElementsByName("img_plugin"),m=0;m<n.length;m++)n[m].className="hcmsIconOff hcmsIconList"}else if(document.forms.contextmenu_user){document.forms.contextmenu_user.elements.contextmenustatus.value="visible";var o=document.forms.contextmenu_user.elements.multiobject.value;""!=document.forms.contextmenu_user.elements.login.value?(document.getElementById("img_edit")&&(document.getElementById("img_edit").className="hcmsIconOn hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOn hcmsIconList")):(document.getElementById("img_edit")&&(document.getElementById("img_edit").className="hcmsIconOff hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOff hcmsIconList"))}else if(document.forms.contextmenu_queue){document.forms.contextmenu_queue.elements.contextmenustatus.value="visible";o=document.forms.contextmenu_queue.elements.multiobject.value;""!=document.forms.contextmenu_queue.elements.queue_id.value?(document.getElementById("img_edit")&&(document.getElementById("img_edit").className="hcmsIconOn hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOn hcmsIconList")):(document.getElementById("img_edit")&&(document.getElementById("img_edit").className="hcmsIconOff hcmsIconList"),document.getElementById("img_delete")&&(document.getElementById("img_delete").className="hcmsIconOff hcmsIconList"))}return hcms_positionContextmenu(),!0}function hcms_hideContextmenu(){return document.forms.contextmenu_object&&(document.forms.contextmenu_object.elements.contextmenustatus.value="hidden"),document.forms.contextmenu_user&&(document.forms.contextmenu_user.elements.contextmenustatus.value="hidden"),document.forms.contextmenu_queue&&(document.forms.contextmenu_queue.elements.contextmenustatus.value="hidden"),document.all?document.all.contextLayer.style.visibility="hidden":document.layers?document.layers.contextLayer.visibility="hidden":(contextelement=document.getElementById("contextLayer"),contextelement.style.visibility="hidden"),!0}function hcms_submitToWindow(e,t,n,m){return!!document.forms[e]&&(winName="popup"+hcms_uniqid(),document.forms[e].target=winName,hcms_openWindow("",winName,t,n,m),document.forms[e].submit(),!0)}function hcms_submitToPopup(e,t){if(document.forms[e]&&""!=t){var n=document.forms[e];return!!window.top.openPopup("empty.php",t)&&(n.target=t+"Frame",n.submit(),!0)}return!1}function hcms_openPopup(e,t){return""!=e&&""!=t&&(window.top.openPopup(e,t),!0)}function hcms_emptyRecycleBin(e){return hcms_lockContext("true"),document.forms.contextmenu_object&&(check=confirm_delete(),1==check&&(document.forms.contextmenu_object.attributes.action.value="popup_status.php",document.forms.contextmenu_object.elements.action.value="emptybin",document.forms.contextmenu_object.elements.force.value="start",document.forms.contextmenu_object.elements.token.value=e,hcms_submitToPopup("contextmenu_object","recyclebin"))),hcms_lockContext("false"),!0}function hcms_createContextmenuItem(e){if(hcms_lockContext("true"),null!==localStorage.getItem("windowwidth")||localStorage.getItem("windowwidth")>0)var t=localStorage.getItem("windowwidth");else t=800;if(null!==localStorage.getItem("windowheight")||localStorage.getItem("windowheight")>0)var n=localStorage.getItem("windowheight");else n=1e3;if(null!==localStorage.getItem("object_newwindow")&&"true"==localStorage.getItem("object_newwindow"))var m=!0;else m=!1;if(null!==localStorage.getItem("message_newwindow")&&"true"==localStorage.getItem("message_newwindow"))var o=!0;else o=!1;if(null!==localStorage.getItem("user_newwindow")&&"true"==localStorage.getItem("user_newwindow"))var c=!0;else c=!1;if(document.forms.contextmenu_object){var s=!1,l=(v=document.forms.contextmenu_object).elements.contexttype.value,a=v.elements.site.value,u=v.elements.cat.value,i=v.elements.location.value,r=v.elements.page.value,d=(v.elements.pagename.value,v.elements.filetype.value,v.elements.media.value,v.elements.folder.value),_=(y=v.elements.multiobject.value).split("|").length-1,g=v.elements.token.value;if("object"==l||"media"==l||"folder"==l||"none"==l)if("preview"!=e&&"cmsview"!=e&&"chat"!=e||("object"==l||"media"==l?URLparaView="site="+encodeURIComponent(a)+"&cat="+encodeURIComponent(u)+"&location="+encodeURIComponent(i)+"&page="+encodeURIComponent(r)+"&token="+g:"folder"==l&&(URLparaView="site="+encodeURIComponent(a)+"&cat="+encodeURIComponent(u)+"&location="+encodeURIComponent(i+d)+"/&folder="+encodeURIComponent(d)+"&page="+encodeURIComponent(r)+"&token="+g)),"preview"==e)""!=d&&(i=i+d+"/"),openObjectView(i,r,"preview");else if("cmsview"==e)y.split("|").length>2&&parent&&parent.frames&&parent.frames.controlFrame&&parent.frames.controlFrame.submitToWindow?1==m?parent.frames.controlFrame.submitToWindow("page_multiedit.php","","multiedit","status=yes,scrollbars=yes,resizable=yes",t,n):parent.frames.controlFrame.submitToMainFrame("page_multiedit.php",""):1==m?hcms_openWindow("frameset_content.php?ctrlreload=yes&"+URLparaView,"","status=yes,scrollbars=no,resizable=yes",t,n):top.openMainView("frameset_content.php?ctrlreload=yes&"+URLparaView);else if("notify"==e)URLfile="popup_notify.php",v.attributes.action.value=URLfile,hcms_submitToPopup("contextmenu_object","notify");else if("chat"==e){if(_<=1){var p="hcms_openWindow('frameset_content.php?ctrlreload=yes&"+URLparaView+"', '', 'status=yes,scrollbars=no,resizable=yes', 800, 1000);";sendtochat(p)}}else"restore"==e?(v.attributes.action.value="popup_status.php",v.elements.action.value=e,v.elements.force.value="start",hcms_submitToPopup("contextmenu_object","restore"+hcms_uniqid())):"delete"==e?(""==y&&""==r&&""==d||1!=hcms_permission.delete||(s=confirm_delete()),1==s&&(v.attributes.action.value="popup_status.php",v.elements.action.value=e,v.elements.force.value="start",hcms_submitToPopup("contextmenu_object","delete"+hcms_uniqid()))):"cut"==e||"copy"==e||"linkcopy"==e?1==hcms_permission.rename&&(v.attributes.action.value="popup_action.php",v.elements.action.value=e,hcms_submitToPopup("contextmenu_object",e+hcms_uniqid())):"paste"==e?""!=a&&""!=i&&1==hcms_permission.paste&&hcms_openPopup("popup_status.php?force=start&action="+encodeURIComponent(e)+"&site="+encodeURIComponent(a)+"&cat="+encodeURIComponent(u)+"&location="+encodeURIComponent(i)+"&token="+g,"paste"+hcms_uniqid()):"publish"==e||"unpublish"==e?1==hcms_permission.publish&&(URLfile="popup_publish.php",v.attributes.action.value=URLfile,v.elements.action.value=e,v.elements.force.value="start",hcms_submitToPopup("contextmenu_object","publish"+hcms_uniqid())):"favorites_create"==e?(v.attributes.action.value="popup_action.php",v.elements.action.value="page_favorites_create",hcms_submitToPopup("contextmenu_object","fav"+hcms_uniqid()),allow_tr_submit=!1):"favorites_delete"==e?(v.attributes.action.value="popup_action.php",v.elements.action.value="page_favorites_delete",hcms_submitToPopup("contextmenu_object","fav"+hcms_uniqid()),allow_tr_submit=!1):"checkin"==e?(v.attributes.action.value="popup_action.php",v.elements.action.value="page_unlock",hcms_submitToPopup("contextmenu_object","checkin"+hcms_uniqid()),allow_tr_submit=!1):""!=e&&(v.attributes.action.value=e,v.attributes.target.value="workplFrame",v.elements.action.value="plugin",v.submit(),allow_tr_submit=!1)}else if(document.forms.contextmenu_user){s=!1,a=(v=document.forms.contextmenu_user).elements.site.value;var f=v.elements.group.value,h=v.elements.login.value,y=v.multiobject.value;g=v.elements.token.value;"edit"==e?1==c?hcms_openWindow("user_edit.php?site="+encodeURIComponent(a)+"&group="+encodeURIComponent(f)+"&login="+encodeURIComponent(h)+"&token="+g,"edit","status=yes,scrollbars=yes,resizable=yes",560,800):parent.openPopup("user_edit.php?site="+encodeURIComponent(a)+"&group="+encodeURIComponent(f)+"&login="+encodeURIComponent(h)+"&token="+g):"delete"==e&&(""==y&&""==h||(s=confirm_delete()),1==s&&(v.attributes.action.value="control_user_menu.php",v.attributes.target.value="controlFrame",v.elements.action.value=e,v.submit(),allow_tr_submit=!1))}else if(document.forms.contextmenu_queue){s=!1,a=(v=document.forms.contextmenu_queue).elements.site.value,u=v.elements.cat.value,i=v.elements.location.value,r=v.elements.page.value,v.elements.pagename.value,v.elements.filetype.value;var v,b=v.elements.queueuser.value,I=v.elements.queue_id.value;y=v.elements.multiobject.value,g=v.elements.token.value;"edit"==e?""!=a&&""!=i?1==m?hcms_openWindow("frameset_content.php?site="+encodeURIComponent(a)+"&ctrlreload=yes&cat="+encodeURIComponent(u)+"&location="+encodeURIComponent(i)+"&page="+encodeURIComponent(r)+"&queueuser="+encodeURIComponent(b)+"&queue_id="+encodeURIComponent(I)+"&token="+g,"","status=yes,scrollbars=no,resizable=yes",800,1e3):top.openMainView("frameset_content.php?site="+encodeURIComponent(a)+"&ctrlreload=yes&cat="+encodeURIComponent(u)+"&location="+encodeURIComponent(i)+"&page="+encodeURIComponent(r)+"&queueuser="+encodeURIComponent(b)+"&queue_id="+encodeURIComponent(I)+"&token="+g):""!=r&&(1==o?hcms_openWindow("user_sendlink.php?mailfile="+encodeURIComponent(r)+"&cat="+encodeURIComponent(u)+"&queueuser="+encodeURIComponent(b)+"&queue_id="+encodeURIComponent(I)+"&token="+g,"","status=yes,scrollbars=no,resizable=yes",600,800):""!=r&&parent.openPopup("user_sendlink.php?mailfile="+encodeURIComponent(r)+"&cat="+encodeURIComponent(u)+"&queueuser="+encodeURIComponent(b)+"&queue_id="+encodeURIComponent(I)+"&token="+g)):"delete"==e&&(""==y&&""==r||(s=confirm_delete()),1==s&&(v.attributes.action.value="control_queue_menu.php",v.attributes.target.value="controlFrame",v.elements.action.value=e,v.submit(),allow_tr_submit=!1))}else if(document.forms.contextmenu_message){s=!1;var x=document.forms.contextmenu_message.elements.messageuser.value,E=document.forms.contextmenu_message.elements.message_id.value;y=document.forms.contextmenu_message.elements.multiobject.value,g=document.forms.contextmenu_message.elements.token.value;"edit"==e?1==o?hcms_openWindow("user_sendlink.php?mailfile="+encodeURIComponent(E)+"&cat=comp&messageuser="+encodeURIComponent(x)+"&token="+g,"","status=yes,scrollbars=no,resizable=yes",600,800):parent.openPopup("user_sendlink.php?mailfile="+encodeURIComponent(E)+"&cat=comp&messageuser="+encodeURIComponent(x)+"&token="+g):"delete"==e&&(""==y&&""==E||(s=confirm_delete()),1==s&&(document.forms.contextmenu_message.attributes.action.value="control_message_menu.php",document.forms.contextmenu_message.attributes.target.value="controlFrame",document.forms.contextmenu_message.elements.action.value=e,document.forms.contextmenu_message.submit(),allow_tr_submit=!1))}return hcms_lockContext("false"),!0}function hcms_setObjectcontext(e,t,n,m,o,c,s,l,a,u){if(document.forms.contextmenu_object&&0==hcms_isLockedContext()){if(hcms_hideContextmenu(),!i)var i=window.event;var r;null!=i.stopPropagation&&i.stopPropagation(),r=""!=l?"folder":""!=s?"media":""!=m?"object":"none";var d=document.forms.contextmenu_object;d.style.display="block",document.forms.contextmenu_column&&(document.forms.contextmenu_column.style.display="none"),d.elements.contexttype.value=r,d.elements.xpos.value=tempX,d.elements.ypos.value=tempY,d.elements.site.value=e,d.elements.cat.value=t,d.elements.location.value=n,d.elements.page.value=m,d.elements.pagename.value=o,d.elements.filetype.value=c,d.elements.media.value=s,d.elements.folder.value=l,d.elements.folder_id&&(d.elements.folder_id.value=a),d.elements.token.value=u}return!0}function hcms_setColumncontext(){if(document.forms.contextmenu_column){if(hcms_hideContextmenu(),!e)var e=window.event;null!=e.stopPropagation&&e.stopPropagation(),document.forms.contextmenu_column.style.display="block",document.forms.contextmenu_object&&(document.forms.contextmenu_object.style.display="none")}return!0}function hcms_setUsercontext(e,t,n){if(document.forms.contextmenu_user&&0==hcms_isLockedContext()){if(hcms_hideContextmenu(),!m)var m=window.event;null!=m.stopPropagation&&m.stopPropagation();var o=document.forms.contextmenu_user;o.elements.xpos.value=tempX,o.elements.ypos.value=tempY,o.elements.site.value=e,o.elements.login.value=t,o.elements.token.value=n}return!0}function hcms_setQueuecontext(e,t,n,m,o,c,s,l,a){if(document.forms.contextmenu_queue&&0==hcms_isLockedContext()){if(hcms_hideContextmenu(),!u)var u=window.event;null!=u.stopPropagation&&u.stopPropagation();var i=document.forms.contextmenu_queue;i.elements.xpos.value=tempX,i.elements.ypos.value=tempY,i.elements.site.value=e,i.elements.cat.value=t,i.elements.location.value=n,i.elements.page.value=m,i.elements.pagename.value=o,i.elements.filetype.value=c,i.elements.queueuser.value=s,i.elements.queue_id.value=l,i.elements.token.value=a}return!0}function hcms_setMessagecontext(e,t,n){if(document.forms.contextmenu_message&&0==hcms_isLockedContext()){if(hcms_hideContextmenu(),!m)var m=window.event;null!=m.stopPropagation&&m.stopPropagation();var o=document.forms.contextmenu_message;o.elements.xpos.value=tempX,o.elements.ypos.value=tempY,o.elements.messageuser.value=e,o.elements.message_id.value=t,o.elements.token.value=n}return!0}function hcms_replace(e,t,n){var m=e.length,o=t.length;if(0==m||0==o)return e;var c=e.indexOf(t);if(!c&&t!=e.substring(0,o))return e;if(-1==c)return e;var s=e.substring(0,c)+n;return c+o<m&&(s+=hcms_replace(e.substring(c+o,m),t,n)),s}function hcms_endsWith(e,t){return-1!==e.indexOf(t,e.length-t.length)}function hcms_selectObject(e,t){var n=!1;if(""==e)return!1;if(e=(e=(e=(e=e.replace("g","")).replace("h","")).replace("_0","")).replace("t",""),document.forms.contextmenu_object?n=document.forms.contextmenu_object:document.forms.contextmenu_user?n=document.forms.contextmenu_user:document.forms.contextmenu_queue?n=document.forms.contextmenu_queue:document.forms.contextmenu_message&&(n=document.forms.contextmenu_message),0==n)return!1;if(""==n.elements.multiobject.value&&hcms_unselectAll(),1==hcms_keyPressed("ctrl",t)||"selectarea"==t||is_mobile){var m=(c=n.elements.multiobject.value)+"|";if(_=document.getElementById("h"+e+"_0").getElementsByTagName("A"))var o=_[0].getAttribute("data-objectpath");else o="";return""!=o&&("|"==c||-1==m.indexOf("|"+o+"|")?(n.elements.multiobject.value=c+"|"+o,document.getElementById("g"+e).className="hcmsObjectSelected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectSelected"),!0):""!=c&&(c==o?n.elements.multiobject.value=hcms_replace(c,o,""):hcms_endsWith(c,"|"+o)?n.elements.multiobject.value=hcms_replace(c,"|"+o,""):n.elements.multiobject.value=hcms_replace(c,"|"+o+"|","|"),document.getElementById("g"+e).className="hcmsObjectUnselected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectUnselected"),!0))}if(1!=hcms_keyPressed("shift",t)){if(hcms_unselectAll(),(_=document.getElementById("h"+e+"_0").getElementsByTagName("A"))[0])o=_[0].getAttribute("data-objectpath");else o="";return""!=o&&(n.elements.multiobject.value="|"+o,document.getElementById("g"+e).className="hcmsObjectSelected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectSelected"),!0)}var c;m=(c=n.elements.multiobject.value)+"|";if(_=document.getElementById("h"+e+"_0").getElementsByTagName("A"))var o=_[0].getAttribute("data-objectpath");else var o="";if(""==o)return!1;if(""==c)return n.elements.multiobject.value=c+"|"+o,document.getElementById("g"+e).className="hcmsObjectSelected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectSelected"),!0;if(""!=c){var s=c.substring(c.lastIndexOf("|")+1),l=o,a=document.getElementById("objectlist").getElementsByTagName("TR"),u=(e=0,!1),r=!1,d="";for(i=0;i<a.length;i++){var _;o=(_=a[i].getElementsByTagName("A"))?_[0].getAttribute("data-objectpath"):"","1"==d&&1==u&&0==r&&-1==m.indexOf("|"+o+"|")&&(c=c+"|"+o,e=(e=a[i].id).substr(1),a[i].className="hcmsObjectSelected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectSelected")),o==s?(""==d&&(d="1"),0==u?u=!0:1==u&&(r=!0)):o==l&&(""==d&&(d="0"),0==u?u=!0:1==u&&(r=!0)),"0"==d&&1==u&&0==r&&-1==m.indexOf("|"+o+"|")&&(c=c+"|"+o,e=(e=a[i].id).substr(1),a[i].className="hcmsObjectSelected",document.getElementById("objectgallery")&&(document.getElementById("t"+e).className="hcmsObjectSelected"))}return n.elements.multiobject.value=c,!0}}function hcms_updateControlObjectListMenu(){return!!document.forms.contextmenu_object&&(document.forms.contextmenu_object.attributes.action.value="control_objectlist_menu.php",document.forms.contextmenu_object.attributes.target.value="controlFrame",document.forms.contextmenu_object.elements.action.value="",allow_tr_submit&&""!=document.forms.contextmenu_object.elements.location.value?document.forms.contextmenu_object.submit():allow_tr_submit=!0,is_mobile||hcms_loadSidebar(),!0)}function hcms_updateControlUserMenu(){if(document.forms.contextmenu_user){var e=document.forms.contextmenu_user;return e.attributes.action.value="control_user_menu.php",e.attributes.target.value="controlFrame",e.elements.action.value="",allow_tr_submit?e.submit():allow_tr_submit=!0,!0}return!1}function hcms_updateControlQueueMenu(){if(document.forms.contextmenu_queue){var e=document.forms.contextmenu_queue;return e.attributes.action.value="control_queue_menu.php",e.attributes.target.value="controlFrame",e.elements.action.value="",allow_tr_submit?e.submit():allow_tr_submit=!0,!0}return!1}function hcms_updateControlMessageMenu(){return!!document.forms.contextmenu_message&&(document.forms.contextmenu_message.attributes.action.value="control_message_menu.php",document.forms.contextmenu_message.attributes.target.value="controlFrame",document.forms.contextmenu_message.elements.action.value="",allow_tr_submit?document.forms.contextmenu_message.submit():allow_tr_submit=!0,!0)}function hcms_selectAll(){if(document.getElementById("objectlist")){var e="",t="",n=document.getElementById("objectlist").getElementsByTagName("TR");for(i=0;i<n.length;i++)(e=n[i].getElementsByTagName("A"))&&(object=e[0].getAttribute("data-objectpath"),""!=object&&(t=t+"|"+object)),n[i].className="hcmsObjectSelected"}if(document.getElementById("objectgallery")){var m=document.getElementById("objectgallery").children;for(i=0;i<m.length;i++)m[i].className="hcmsObjectSelected"}return document.forms.contextmenu_object&&document.forms.contextmenu_object.elements.multiobject?(document.forms.contextmenu_object.elements.multiobject.value=t,hcms_updateControlObjectListMenu()):document.forms.contextmenu_user&&document.forms.contextmenu_user.elements.multiobject?(document.forms.contextmenu_user.elements.multiobject.value=t,hcms_updateControlUserMenu()):document.forms.contextmenu_queue&&document.forms.contextmenu_queue.elements.multiobject?(document.forms.contextmenu_queue.elements.multiobject.value=t,hcms_updateControlQueueMenu()):document.forms.contextmenu_message&&document.forms.contextmenu_message.elements.multiobject&&(document.forms.contextmenu_message.elements.multiobject.value=t,hcms_updateControlMessageMenu()),!0}function hcms_unselectAll(){if(document.getElementById("objectlist")){var e=document.getElementById("objectlist").getElementsByTagName("TR");for(i=0;i<e.length;i++)e[i].className="hcmsObjectUnselected"}if(document.getElementById("objectgallery")){var t=document.getElementById("objectgallery").children;for(i=0;i<t.length;i++)t[i].className="hcmsObjectUnselected"}return document.forms.contextmenu_object&&document.forms.contextmenu_object.elements.multiobject.value?(document.forms.contextmenu_object.elements.multiobject.value="",hcms_updateControlObjectListMenu()):document.forms.contextmenu_user&&document.forms.contextmenu_user.elements.multiobject.value?(document.forms.contextmenu_user.elements.multiobject.value="",hcms_updateControlUserMenu()):document.forms.contextmenu_queue&&document.forms.contextmenu_queue.elements.multiobject.value?(document.forms.contextmenu_queue.elements.multiobject.value="",hcms_updateControlQueueMenu()):document.forms.contextmenu_message&&document.forms.contextmenu_message.elements.multiobject.value&&(document.forms.contextmenu_message.elements.multiobject.value="",hcms_updateControlMessageMenu()),!0}function hcms_Contextmenu(e){if(!e)e=window.event;return 1==activatelinks||(null!=e.preventDefault&&e.preventDefault(),null!=e.stopPropagation&&e.stopPropagation(),!1)}function hcms_rightClickContext(e){if(!e)e=window.event;return 0==activatelinks&&((!e.which||2!=e.which&&3!=e.which)&&(!e.button||2!=e.button&&3!=e.button)||hcms_showContextmenu(),hcms_startSelectArea(e)),!1}function hcms_leftClickContext(e){if(!e)e=window.event;var t,n,m=0;return is_mobile&&1==hcms_permission.minnavframe&&"function"==typeof top.minNavFrame&&top.minNavFrame(),hcms_clearSelection(),document.forms.contextmenu_object?(t=document.forms.contextmenu_object.elements.page.value,n=document.forms.contextmenu_object.elements.multiobject.value):document.forms.contextmenu_user?(t=document.forms.contextmenu_user.elements.login.value,n=document.forms.contextmenu_user.elements.multiobject.value):document.forms.contextmenu_queue?(t=document.forms.contextmenu_queue.elements.page.value,n=document.forms.contextmenu_queue.elements.multiobject.value):document.forms.contextmenu_message&&(t=document.forms.contextmenu_message.elements.message_id.value,n=document.forms.contextmenu_message.elements.multiobject.value),""!=n&&(m=n.split("|").length-1),0!=e.which&&1!=e.which&&0!=e.button&&1!=e.button||(hcms_hideContextmenu(),0==hcms_keyPressed("",e)&&""==t&&m>=1&&0==is_selectarea&&(hcms_unselectAll(),hcms_resetContext())),!1}function hcms_getlink(e,t){if(""!=e){var n="",m="";return $.ajax({async:!1,type:"POST",url:"service/getlink.php",data:{location:e},dataType:"json",success:function(e){e.success&&(n=e.downloadlink,m=e.downloadlink)}}),"download"==t&&""!=n?n:"wrapper"==t&&""!=m&&m}return!1}function hcms_activateLinks(e){if(!e)e=window.event;if(0==is_dragndrop&&hcms_keyPressed("alt",e)&&document.forms.contextmenu_object){for(var t=document.getElementsByTagName("A"),n=!1,m=!1,o=0;o<t.length;o++){var c=t[o],s=c.getAttribute("data-href"),l=c.getAttribute("data-objectpath"),a=c.getAttribute("data-linktype");if("download"==a||"wrapper"==a){if(0==activatelinks)if(""!=s){(u=document.createAttribute("href")).nodeValue=s,c.setAttributeNode(u)}else{0==m&&document.getElementById("hcmsLoadScreen")&&(document.getElementById("hcmsLoadScreen").style.display="inline",m=!0);var u;s=hcms_getlink(l,a);c.setAttribute("data-href",s),(u=document.createAttribute("href")).nodeValue=s,c.setAttributeNode(u)}else{var i=c.getAttributeNode("href");c.removeAttributeNode(i)}n=!0}}1==n&&(0==activatelinks?(document.getElementsByTagName("body")[0].className="hcmsWorkplaceObjectlistLinks",activatelinks=!0,document.getElementById("hcmsLoadScreen")&&(document.getElementById("hcmsLoadScreen").style.display="none")):(document.getElementsByTagName("body")[0].className="hcmsWorkplaceObjectlist",activatelinks=!1))}}function hcms_startSelectArea(e){if(!e)e=window.event;return!(0!=activatelinks||!selectarea||0!=e.which&&1!=e.which&&0!=e.button&&1!=e.button)&&(x1=e.clientX,y1=e.clientY,is_dragndrop=!1,!0)}function hcms_drawSelectArea(){return!!(0==is_dragndrop&&0==activatelinks&&selectarea&&x1>0&&y1>0&&(is_selectarea=!0,x3=Math.min(x1,x2),x4=Math.max(x1,x2),y3=Math.min(y1,y2),y4=Math.max(y1,y2),hcms_clearSelection(),(""==selectarea.style.display||"none"==selectarea.style.display)&&x4-x3>5&&y4-y3>5&&(selectarea.style.display="inline"),"none"!=selectarea.style.display))&&(selectarea.style.left=x3+"px",selectarea.style.top=y3+"px",selectarea.style.width=x4-x3+"px",selectarea.style.height=y4-y3+"px",!0)}function hcms_endSelectArea(){var e=!1;if(0==is_dragndrop&&0==activatelinks&&selectarea&&"none"!=selectarea.style.display&&x1>0&&y1>0&&0!=x3&&0!=y3&&0!=x4&&0!=y4&&x4-x3>5&&y4-y3>5){if(hcms_unselectAll(),document.getElementById("objectLayer")&&"visible"==document.getElementById("objectLayer").style.visibility)var t=document.getElementsByClassName("hcmsObjectListMarker"),n=80,m=10;else if(document.getElementById("galleryviewLayer")&&"visible"==document.getElementById("galleryviewLayer").style.visibility)t=document.getElementsByClassName("hcmsObjectGalleryMarker"),n=80,m=80;if(t&&t.length>0){for(var o,c,s,l=0;l<t.length;l++)c=(o=t[l].getBoundingClientRect()).left,s=o.top,c>=x3-n&&s>=y3-m&&c<=x4-n&&s<=y4-m&&(hcms_selectObject(t[l].parentElement.id,"selectarea"),e=!0);e&&(document.forms.contextmenu_object?setTimeout(hcms_updateControlObjectListMenu,300):document.forms.contextmenu_user?setTimeout(hcms_updateControlUserMenu,300):document.forms.contextmenu_queue?setTimeout(hcms_updateControlQueueMenu,300):document.forms.contextmenu_message&&setTimeout(hcms_updateControlMessageMenu,300))}}return x1=0,y1=0,x2=0,y2=0,x3=0,y3=0,x4=0,y4=0,selectarea&&(setTimeout(function(){is_selectarea=!1},300),selectarea.style.display="none"),!!e}function hcms_collectObjectpath(){if(document.getElementById("h0_0"))for(var e=null,t=0;e=document.getElementById("h"+t+"_0");){var n=e.getElementsByTagName("A");n[0].getAttribute("data-objectpath")&&(hcms_objectpath[t]=n[0].getAttribute("data-objectpath")),t++}hcms_objectpath&&(parent.hcms_objectpath=hcms_objectpath)}function hcms_findElementByTagName(e,t){if(""!=t){if(t=t.toUpperCase(),e.tagName==t)return e;for(;e.parentNode;)if((e=e.parentNode).tagName==t)return e}return null}function hcms_setDragImage(e){if(1==is_dragndrop&&"ie"!=hcms_getBrowserName()&&e.dataTransfer&&"function"==typeof e.dataTransfer.setDragImage){var t=document.createElement("img");t.src=themelocation+"/img/button_file_copy.png",e.dataTransfer.setDragImage(t,32,32)}}function hcms_drag(e){if(!is_mobile&&"ie"!=hcms_getBrowserName()&&e.dataTransfer&&"function"==typeof e.dataTransfer.setData&&document.forms.contextmenu_object){is_dragndrop=!0,hcms_setDragImage(e);var t=document.forms.contextmenu_object;e.dataTransfer.setData("action",t.elements.action.value),e.dataTransfer.setData("force",t.elements.force.value),e.dataTransfer.setData("contexttype",t.elements.contexttype.value),e.dataTransfer.setData("site",t.elements.site.value),e.dataTransfer.setData("cat",t.elements.cat.value),e.dataTransfer.setData("location",t.elements.location.value),e.dataTransfer.setData("page",t.elements.page.value),e.dataTransfer.setData("pagename",t.elements.pagename.value),e.dataTransfer.setData("filetype",t.elements.filetype.value),e.dataTransfer.setData("media",t.elements.media.value),e.dataTransfer.setData("folder",t.elements.folder.value),e.dataTransfer.setData("multiobject",t.elements.multiobject.value),e.dataTransfer.setData("token",t.elements.token.value),e.dataTransfer.setData("convert_type",t.elements.convert_type.value),e.dataTransfer.setData("convert_cfg",t.elements.convert_cfg.value)}}function hcms_drop(e){if(!is_mobile&&"ie"!=hcms_getBrowserName()&&e.target&&e.dataTransfer&&"function"==typeof e.dataTransfer.getData&&e.dataTransfer.getData("site")&&e.dataTransfer.getData("location")&&document.forms.contextmenu_object){e.preventDefault();var t=hcms_findElementByTagName(e.target,"A");if(t){var n=document.forms.memory,m=t.getAttribute("data-objectpath");n.attributes.action.value="popup_status.php",hcms_keyPressed("alt",e)?n.elements.action.value="linkcopy->paste":hcms_keyPressed("ctrl",e)?n.elements.action.value="copy->paste":n.elements.action.value="cut->paste",n.elements.force.value="start",n.elements.contexttype.value=e.dataTransfer.getData("contexttype"),n.elements.site.value=e.dataTransfer.getData("site"),n.elements.cat.value=e.dataTransfer.getData("cat"),n.elements.location.value=e.dataTransfer.getData("location"),n.elements.targetlocation.value=m,n.elements.page.value=e.dataTransfer.getData("page"),n.elements.pagename.value=e.dataTransfer.getData("pagename"),n.elements.filetype.value=e.dataTransfer.getData("filetype"),n.elements.media.value=e.dataTransfer.getData("media"),n.elements.folder.value=e.dataTransfer.getData("folder"),n.elements.multiobject.value=e.dataTransfer.getData("multiobject"),n.elements.token.value=e.dataTransfer.getData("token"),n.elements.convert_type.value=e.dataTransfer.getData("convert_type"),n.elements.convert_cfg.value=e.dataTransfer.getData("convert_cfg"),hcms_submitToPopup("memory","drop")}}else is_mobile||e.preventDefault()}function hcms_allowDrop(e){if(!is_mobile&&"ie"!=hcms_getBrowserName()&&e.dataTransfer.items&&document.forms.contextmenu_object){e.preventDefault();for(var t=0;t<e.dataTransfer.items.length;t++)if("file"===e.dataTransfer.items[t].kind&&""!=e.dataTransfer.items[t].type){var n=document.forms.contextmenu_object,m=n.elements.site.value,o=n.elements.cat.value,c=n.elements.location.value;m&&o&&c&&window.top.openPopup("popup_upload_html.php?uploadmode=multi&site="+encodeURIComponent(m)+"&cat="+encodeURIComponent(o)+"&location="+encodeURIComponent(c),"upload"+hcms_md5(c).substr(0,13))}}}hcms_addEvent("keydown",document,function(e){1==hcms_permission.shortcuts&&(hcms_activateLinks(e),!hcms_keyPressed("ctrl",e)||"a"!==e.key&&"A"!=e.key||(e.preventDefault(),hcms_selectAll()),!hcms_keyPressed("ctrl",e)||"x"!=e.key&&"X"!=e.key||(e.preventDefault(),hcms_createContextmenuItem("cut")),!hcms_keyPressed("ctrl",e)||"c"!=e.key&&"C"!=e.key||(e.preventDefault(),hcms_createContextmenuItem("copy")),!hcms_keyPressed("ctrl",e)||"y"!=e.key&&"Y"!=e.key||(e.preventDefault(),hcms_createContextmenuItem("linkcopy")),!hcms_keyPressed("ctrl",e)||"v"!=e.key&&"V"!=e.key||(e.preventDefault(),hcms_createContextmenuItem("paste")),"Delete"!=e.key&&8!=e.keyCode&&46!=e.keyCode||(e.preventDefault(),hcms_createContextmenuItem("delete")))}),hcms_addEvent("mousemove",document,function(e){hcms_getMouseXY(e)}),hcms_addEvent("contextmenu",document,function(e){hcms_Contextmenu(e)}),hcms_addEvent("mousedown",document,function(e){hcms_rightClickContext(e)}),hcms_addEvent("mouseup",document,function(e){hcms_endSelectArea(e)}),hcms_addEvent("click",document,function(e){hcms_leftClickContext(e)}),window.alert=top.alert;